---
description: 
globs: 
alwaysApply: false
---
---
description: "Reglas de Git Commits con Conventional Commits para el equipo de desarrollo"
rule_type: "Always"
---

# Reglas de Cursor para Commits de Git

## Formato de Commits CON ICONOS OBLIGATORIOS
Siempre usa el formato de Conventional Commits CON ICONOS siguiendo la configuraciÃ³n de @commitlint/config-conventional:
```
<icono> <tipo>[Ã¡mbito opcional]: <descripciÃ³n>

[cuerpo opcional]

[pie opcional]
```

## Tipos de Commit (basado en commitlint oficial):

### âœ¨ feat
- **DescripciÃ³n**: A new feature (Una nueva funcionalidad)
- **Uso**: Cuando aÃ±ades nueva funcionalidad al cÃ³digo
- **Ejemplo**: `feat(auth): add JWT token validation`

### ğŸ› fix
- **DescripciÃ³n**: A bug fix (CorrecciÃ³n de un error)
- **Uso**: Cuando corriges un error o bug
- **Ejemplo**: `fix(customer): resolve status update validation error`

### ğŸ“š docs
- **DescripciÃ³n**: Documentation only changes (Solo cambios en documentaciÃ³n)
- **Uso**: Cuando solo modificas documentaciÃ³n
- **Ejemplo**: `docs: update API endpoints documentation`

### ğŸ’ style
- **DescripciÃ³n**: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)
- **Uso**: Cambios de formato que no afectan la lÃ³gica
- **Ejemplo**: `style: fix code formatting and remove trailing spaces`

### ğŸ“¦ refactor
- **DescripciÃ³n**: A code change that neither fixes a bug nor adds a feature
- **Uso**: ReestructuraciÃ³n de cÃ³digo sin cambiar funcionalidad
- **Ejemplo**: `refactor(maintable): simplify repository implementation`

### ğŸš€ perf
- **DescripciÃ³n**: A code change that improves performance
- **Uso**: Mejoras de rendimiento
- **Ejemplo**: `perf(database): optimize query execution time`

### ğŸš¨ test
- **DescripciÃ³n**: Adding missing tests or correcting existing tests
- **Uso**: AÃ±adir o corregir tests
- **Ejemplo**: `test(services): add unit tests for category service`

### ğŸ›  build
- **DescripciÃ³n**: Changes that affect the build system or external dependencies
- **Uso**: Cambios en el sistema de build o dependencias
- **Ejemplo**: `build: update Python dependencies to latest versions`

### âš™ï¸ ci
- **DescripciÃ³n**: Changes to CI configuration files and scripts
- **Uso**: Cambios en configuraciÃ³n de CI/CD
- **Ejemplo**: `ci: add automated testing workflow`

### â™»ï¸ chore
- **DescripciÃ³n**: Other changes that don't modify src or test files
- **Uso**: Tareas de mantenimiento general
- **Ejemplo**: `chore: update gitignore and remove unused imports`

### ğŸ—‘ revert
- **DescripciÃ³n**: Reverts a previous commit
- **Uso**: Revertir un commit anterior
- **Ejemplo**: `revert: undo changes in customer validation logic`

## Ãmbitos (Scopes) para este Proyecto:
Basado en la estructura del proyecto, usa estos Ã¡mbitos cuando sea relevante:

- **auth**: AutenticaciÃ³n y autorizaciÃ³n
- **customer**: GestiÃ³n de clientes  
- **location**: GestiÃ³n de ubicaciones
- **services**: GestiÃ³n de servicios y categorÃ­as
- **maintable**: Tablas maestras y catÃ¡logos
- **user**: GestiÃ³n de usuarios
- **shifts**: GestiÃ³n de turnos de trabajo
- **days_off**: GestiÃ³n de dÃ­as libres
- **user_locations**: AsignaciÃ³n usuario-ubicaciones
- **share**: Utilidades y servicios compartidos
- **config**: ConfiguraciÃ³n de la aplicaciÃ³n
- **database**: Cambios en base de datos y migraciones
- **api**: Endpoints y rutas de API

## Reglas para el Subject (DescripciÃ³n):
1. **MÃ¡ximo 50-72 caracteres**
2. **MinÃºsculas**: No capitalizar la primera letra
3. **Sin punto final**: No terminar con punto
4. **Imperativo**: Usa verbos en presente imperativo ("add", "fix", "update", no "added", "fixed", "updated")
5. **Describe QUÃ‰ hace el cambio**, no cÃ³mo lo hace

## Estructura del Body (Cuerpo) - Opcional:
- **CuÃ¡ndo usar**: Para explicar el "por quÃ©" del cambio
- **Formato**: MÃ¡ximo 72 caracteres por lÃ­nea
- **Contenido**: 
  - Motivo del cambio
  - ComparaciÃ³n con comportamiento anterior
  - Efectos secundarios o consideraciones

## Estructura del Footer (Pie) - Opcional:
- **Breaking Changes**: `BREAKING CHANGE: descripciÃ³n del cambio disruptivo`
- **Issues**: `Closes #123`, `Fixes #456`, `Refs #789`
- **Co-authored-by**: Para mÃºltiples autores

## Ejemplos Completos:

### Commit Simple CON ICONO:
```
âœ¨ feat(auth): add Google OAuth2 integration
```

### Commit con Body CON ICONO:
```
ğŸ› fix(customer): resolve customer status update issue

The status validation was incorrectly rejecting valid status 
transitions. Updated the validation logic to allow all 
documented status flows.

Fixes #142
```

### Commit con Breaking Change CON ICONO:
```
âœ¨ feat(api): change authentication endpoint structure

BREAKING CHANGE: The /auth/login endpoint now returns tokens 
in a different format. Update client applications to use the 
new 'accessToken' and 'refreshToken' fields instead of 'token'.
```

## Mensajes de Error Comunes y Soluciones:

âŒ **Error**: "subject may not be empty"
âœ… **SoluciÃ³n**: Siempre incluye una descripciÃ³n despuÃ©s del tipo

âŒ **Error**: "type may not be empty" 
âœ… **SoluciÃ³n**: Siempre especifica un tipo (feat, fix, etc.)

âŒ **Error**: "subject must not be sentence-case"
âœ… **SoluciÃ³n**: Usa minÃºsculas: `feat: add feature` no `feat: Add feature`

âŒ **Error**: "header must not be longer than 100 characters"
âœ… **SoluciÃ³n**: MantÃ©n el header completo bajo 100 caracteres

## Flujo de Trabajo Recomendado:

1. **Antes del commit**: Revisa quÃ© archivos cambiaste
2. **Identifica el tipo**: Â¿Es nueva funcionalidad, fix, refactor, etc.?
3. **Determina el Ã¡mbito**: Â¿QuÃ© mÃ³dulo o Ã¡rea afecta?
4. **Escribe la descripciÃ³n**: Breve, imperativo, sin punto final
5. **AÃ±ade body si es necesario**: Para cambios complejos
6. **Referencia issues**: Si aplica

## Comandos Ãštiles:

```bash
# Ver cambios antes del commit
git diff --staged

# Commit interactivo (si tienes commitizen)
npx cz

# Validar mensaje de commit
npx commitlint --edit

# Ver historial de commits formateados
git log --oneline --decorate
```

## REGLAS ESPECÃFICAS PARA GENERACIÃ“N DE COMMITS

### Cuando Generes Commit Messages AutomÃ¡ticamente:

1. **ANALIZA los archivos staged** para determinar el tipo y Ã¡mbito correcto
2. **USA SIEMPRE** el formato Conventional Commits CON ICONOS definido arriba
3. **INCLUYE SIEMPRE** el icono correspondiente al tipo de commit
4. **IDENTIFICA el Ã¡mbito** basado en los directorios modificados usando el mapeo siguiente
5. **ESCRIBE la descripciÃ³n** en imperativo, minÃºsculas y sin punto final
6. **NO EXCEDAS 72 caracteres** en el header (incluye icono + tipo + Ã¡mbito + descripciÃ³n)
7. **INCLUYE body** solo si los cambios requieren explicaciÃ³n del "por quÃ©"

### âš ï¸ REGLA CRÃTICA: USO OBLIGATORIO DE ICONOS
**TODOS los commits DEBEN incluir el icono correspondiente al tipo:**
- âœ¨ feat â†’ Para nuevas caracterÃ­sticas
- ğŸ› fix â†’ Para correcciÃ³n de errores
- â™»ï¸ refactor â†’ Para refactorizaciÃ³n
- ğŸ“ docs â†’ Para documentaciÃ³n
- ğŸ¨ style â†’ Para estilos/formato
- âš¡ perf â†’ Para optimizaciones
- ğŸ§ª test â†’ Para pruebas
- ğŸ“¦ build â†’ Para sistema de build
- ğŸš€ ci â†’ Para CI/CD
- ğŸ”§ chore â†’ Para mantenimiento

### Mapeo AutomÃ¡tico de Archivos a Ãmbitos:

**Directorio â†’ Ãmbito:**
- `app/modules/auth/` â†’ `auth`
- `app/modules/customer/` â†’ `customer`
- `app/modules/location/` â†’ `location`
- `app/modules/services/` â†’ `services`
- `app/modules/maintable/` â†’ `maintable`
- `app/modules/user/` â†’ `user`
- `app/modules/shifts/` â†’ `shifts`
- `app/modules/days_off/` â†’ `days_off`
- `app/modules/user_locations/` â†’ `user_locations`
- `app/modules/share/` â†’ `share`
- `config/` â†’ `config`
- `alembic/` â†’ `database`
- `app/main.py` â†’ `api`
- `pyproject.toml` â†’ `build`
- `package.json` â†’ `build`
- `commitlint.config.mjs` â†’ `ci`
- `README.md` â†’ `docs`
- `.cursorrules` â†’ `chore`
- `.cursor/` â†’ `chore`

### LÃ³gica para Determinar Tipo de Commit:

- **feat**: Nuevos archivos, nuevas funciones, nuevos endpoints
- **fix**: Correcciones de bugs, validaciones, errores
- **refactor**: Cambios de estructura sin nueva funcionalidad
- **chore**: Archivos de configuraciÃ³n, dependencias, limpieza
- **docs**: Solo cambios en documentaciÃ³n
- **test**: Archivos de pruebas
- **style**: Formateo, espacios, imports sin cambio de lÃ³gica
- **perf**: Optimizaciones de rendimiento
- **build**: Cambios en dependencias, build tools
- **ci**: Cambios en CI/CD, workflows

### Formato de Salida Requerido:

```
<tipo>(<Ã¡mbito>): <descripciÃ³n breve>

[Body opcional si es necesario explicar el por quÃ©]
```

**Ejemplos correctos basados en tu proyecto:**
- `feat(maintable): add query handler for criteria filtering`
- `fix(customer): resolve status validation error`  
- `refactor(share): simplify data shaper service logic`
- `chore(build): update Python dependencies`
- `docs: update API endpoints documentation`



